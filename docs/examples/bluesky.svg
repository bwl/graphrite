<svg xmlns="http://www.w3.org/2000/svg" width="1090" height="662" viewBox="0 0 1090 662">
  <defs><marker id="arrow" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M0 0 L10 5 L0 10 z" fill="#333"/></marker></defs>
  <polyline fill="none" stroke="#333" stroke-width="2" marker-end="url(#arrow)" points="250.0,212.0 295.0,212.0 340.0,448.0"/>
  <polyline fill="none" stroke="#333" stroke-width="2" marker-end="url(#arrow)" points="250.0,212.0 295.0,212.0 340.0,212.0"/>
  <polyline fill="none" stroke="#333" stroke-width="2" marker-end="url(#arrow)" points="250.0,212.0 295.0,212.0 340.0,330.0"/>
  <polyline fill="none" stroke="#333" stroke-width="2" marker-end="url(#arrow)" points="500.0,94.0 545.0,94.0 590.0,212.0"/>
  <polyline fill="none" stroke="#333" stroke-width="2" marker-end="url(#arrow)" points="500.0,94.0 670.0,94.0 840.0,94.0"/>
  <polyline fill="none" stroke="#333" stroke-width="2" marker-end="url(#arrow)" points="500.0,94.0 545.0,94.0 590.0,94.0"/>
  <polyline fill="none" stroke="#333" stroke-width="2" marker-end="url(#arrow)" points="500.0,94.0 670.0,94.0 840.0,212.0"/>
  <polyline fill="none" stroke="#333" stroke-width="2" marker-end="url(#arrow)" points="500.0,212.0 545.0,212.0 590.0,330.0"/>
  <polyline fill="none" stroke="#333" stroke-width="2" marker-end="url(#arrow)" points="750.0,330.0 795.0,330.0 840.0,330.0"/>
  <polyline fill="none" stroke="#333" stroke-width="2" marker-end="url(#arrow)" points="750.0,330.0 795.0,330.0 840.0,94.0"/>
  <polyline fill="none" stroke="#333" stroke-width="2" marker-end="url(#arrow)" points="750.0,330.0 795.0,330.0 840.0,212.0"/>
  <polyline fill="none" stroke="#333" stroke-width="2" marker-end="url(#arrow)" points="500.0,94.0 545.0,94.0 590.0,448.0"/>
  <polyline fill="none" stroke="#333" stroke-width="2" marker-end="url(#arrow)" points="250.0,94.0 295.0,94.0 340.0,94.0"/>
  <polyline fill="none" stroke="#333" stroke-width="2" marker-end="url(#arrow)" points="250.0,330.0 420.0,330.0 590.0,448.0"/>
  <rect x="90.0" y="70.0" rx="6" ry="6" width="160.0" height="48.0" fill="#ffffff" stroke="#333333"/>
  <text x="170.0" y="94.0" font-family="sans-serif" font-size="12" text-anchor="middle" dominant-baseline="middle">Mobile/Web Client</text>
  <rect x="340.0" y="70.0" width="160.0" height="48.0" fill="#e3f2fd" stroke="#1565c0"/>
  <ellipse cx="420.0" cy="70.0" rx="80.0" ry="6" fill="#e3f2fd" stroke="#1565c0"/>
  <ellipse cx="420.0" cy="118.0" rx="80.0" ry="6" fill="#e3f2fd" stroke="#1565c0"/>
  <text x="420.0" y="94.0" font-family="sans-serif" font-size="12" text-anchor="middle" dominant-baseline="middle">Personal Data Server (PDS)</text>
  <rect x="340.0" y="188.0" rx="6" ry="6" width="160.0" height="48.0" fill="#ffffff" stroke="#333333"/>
  <text x="420.0" y="212.0" font-family="sans-serif" font-size="12" text-anchor="middle" dominant-baseline="middle">Relay/Message Broker</text>
  <rect x="340.0" y="306.0" rx="6" ry="6" width="160.0" height="48.0" fill="#ffffff" stroke="#333333"/>
  <text x="420.0" y="330.0" font-family="sans-serif" font-size="12" text-anchor="middle" dominant-baseline="middle">Identity PLC Directory</text>
  <rect x="340.0" y="424.0" width="160.0" height="48.0" fill="#e3f2fd" stroke="#1565c0"/>
  <ellipse cx="420.0" cy="424.0" rx="80.0" ry="6" fill="#e3f2fd" stroke="#1565c0"/>
  <ellipse cx="420.0" cy="472.0" rx="80.0" ry="6" fill="#e3f2fd" stroke="#1565c0"/>
  <text x="420.0" y="448.0" font-family="sans-serif" font-size="12" text-anchor="middle" dominant-baseline="middle">Repo/Record Store</text>
  <rect x="90.0" y="188.0" rx="6" ry="6" width="160.0" height="48.0" fill="#ffffff" stroke="#333333"/>
  <text x="170.0" y="212.0" font-family="sans-serif" font-size="12" text-anchor="middle" dominant-baseline="middle">ATProto Protocol Layer</text>
  <rect x="840.0" y="70.0" rx="6" ry="6" width="160.0" height="48.0" fill="#ffffff" stroke="#333333"/>
  <text x="920.0" y="94.0" font-family="sans-serif" font-size="12" text-anchor="middle" dominant-baseline="middle">Feed Generator Service</text>
  <rect x="590.0" y="70.0" rx="6" ry="6" width="160.0" height="48.0" fill="#ffffff" stroke="#333333"/>
  <text x="670.0" y="94.0" font-family="sans-serif" font-size="12" text-anchor="middle" dominant-baseline="middle">Social Graph Service</text>
  <rect x="840.0" y="188.0" rx="6" ry="6" width="160.0" height="48.0" fill="#ffffff" stroke="#333333"/>
  <text x="920.0" y="212.0" font-family="sans-serif" font-size="12" text-anchor="middle" dominant-baseline="middle">Moderation Service</text>
  <rect x="590.0" y="188.0" width="160.0" height="48.0" fill="#e3f2fd" stroke="#1565c0"/>
  <ellipse cx="670.0" cy="188.0" rx="80.0" ry="6" fill="#e3f2fd" stroke="#1565c0"/>
  <ellipse cx="670.0" cy="236.0" rx="80.0" ry="6" fill="#e3f2fd" stroke="#1565c0"/>
  <text x="670.0" y="212.0" font-family="sans-serif" font-size="12" text-anchor="middle" dominant-baseline="middle">Blob/Media Store</text>
  <rect x="840.0" y="306.0" rx="6" ry="6" width="160.0" height="48.0" fill="#ffffff" stroke="#333333"/>
  <text x="920.0" y="330.0" font-family="sans-serif" font-size="12" text-anchor="middle" dominant-baseline="middle">Search/Indexing Service</text>
  <rect x="590.0" y="306.0" rx="6" ry="6" width="160.0" height="48.0" fill="#ffffff" stroke="#333333"/>
  <text x="670.0" y="330.0" font-family="sans-serif" font-size="12" text-anchor="middle" dominant-baseline="middle">Firehose Stream</text>
  <rect x="590.0" y="424.0" rx="6" ry="6" width="160.0" height="48.0" fill="#ffffff" stroke="#333333"/>
  <text x="670.0" y="448.0" font-family="sans-serif" font-size="12" text-anchor="middle" dominant-baseline="middle">Federation Gateway</text>
  <rect x="90.0" y="306.0" rx="6" ry="6" width="160.0" height="48.0" fill="#ffffff" stroke="#333333"/>
  <text x="170.0" y="330.0" font-family="sans-serif" font-size="12" text-anchor="middle" dominant-baseline="middle">Third-Party PDS</text>
  <g id="legend">
    <rect x="20.0" y="552.0" width="520" height="100" fill="#fafafa" stroke="#bbb"/>
  <rect x="30.0" y="572.0" rx="15.0" ry="15.0" width="80.0" height="30.0" fill="#e6ffe6" stroke="#2e7d32"/>
    <text x="120.0" y="587.0" font-family="sans-serif" font-size="12">Start/End</text>
  <polygon points="270.0,572.0 310.0,587.0 270.0,602.0 230.0,587.0" fill="#fff9c4" stroke="#f9a825"/>
    <text x="320.0" y="587.0" font-family="sans-serif" font-size="12">Decision</text>
  <rect x="430.0" y="572.0" rx="6" ry="6" width="80.0" height="30.0" fill="#ffffff" stroke="#333333"/>
    <text x="520.0" y="587.0" font-family="sans-serif" font-size="12">Process</text>
  <rect x="30.0" y="612.0" width="80.0" height="30.0" fill="#e3f2fd" stroke="#1565c0"/>
  <ellipse cx="70.0" cy="612.0" rx="40.0" ry="6" fill="#e3f2fd" stroke="#1565c0"/>
  <ellipse cx="70.0" cy="642.0" rx="40.0" ry="6" fill="#e3f2fd" stroke="#1565c0"/>
    <text x="120.0" y="627.0" font-family="sans-serif" font-size="12">Data/Queue</text>
  <rect x="230.0" y="612.0" rx="6" ry="6" width="80.0" height="30.0" fill="#ffebee" stroke="#c62828"/>
    <text x="320.0" y="627.0" font-family="sans-serif" font-size="12">Error</text>
  </g>
</svg>
